<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chi siamo - PIZZIAMO?! - La tua pizzeria di fiducia</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/chi-siamo.css">    <!-- Firebase modules are loaded via ES6 imports in the script -->
</head>
<body>
    <!-- Header con Logo e Menu Principale -->
    <header>
        <div class="container header-container">
            <div class="logo-contact-container">
                <a href="index.html" class="logo">
                    <div id="logo-container">
                        <img src="img/logopizzeria.png" alt="PIZZIAMO Logo">
                    </div>
                </a>
                <div class="contact-info">
                    <div class="address">
                        <i class="icon">üìç</i>
                        <span>Via Pontegradella 289/A, 44123 Ferrara (FE)</span>
                    </div>
                    <div class="phone">
                        <i class="icon">üìû</i>
                        <span>Tel: 000000000</span>
                    </div>
                </div>
            </div>
            <nav class="main-nav">
                <ul>
                    <li><a href="chi-siamo.html" class="active"><i class="icon">üë•</i> Chi siamo</a></li>
                    <li><a href="menu.html"><i class="icon">üçï</i> Men√π</a></li>
                    <li><a href="#app"><i class="icon">üì±</i> Scarica App</a></li>
                </ul>
            </nav>
        </div>
    </header>
    
    <!-- Page Hero -->
    <div class="page-hero">
        <div class="container page-hero-content">
            <h1>Chi Siamo</h1>
            <p>Scopri la nostra storia, i nostri valori e come rendiamo speciali le nostre pizze</p>
            <div class="breadcrumb">
                <a href="index.html">Home</a>
                <span>‚Ä∫</span>
                <a href="chi-siamo.html">Chi siamo</a>
            </div>
        </div>
    </div>
      <!-- Storia Section -->
    <section id="storia" class="section" style="display: none;">
        <div class="container">
            <h2 class="section-title"></h2>
            
            <div class="storia-container">
                <div class="storia-content">
                    <!-- Contenuto caricato dinamicamente da Firebase -->
                </div>
                <div class="storia-image">
                    <!-- Immagine caricata dinamicamente da Firebase -->
                </div>
            </div>
        </div>
    </section>
      <!-- Valori Section -->
    <section id="valori" class="section" style="background-color: var(--light); display: none;">
        <div class="container">
            <h2 class="section-title"></h2>
            
            <div class="valori-container">
                <!-- Contenuto caricato dinamicamente da Firebase -->
            </div>
        </div>
    </section>
      <!-- Ingredienti Section -->
    <section id="ingredienti" class="section" style="display: none;">
        <div class="container">
            <h2 class="section-title"></h2>
            
            <div class="ingredienti-container">
                <div class="ingredienti-intro">
                    <!-- Introduzione caricata dinamicamente da Firebase -->
                </div>
                
                <div class="ingredienti-grid">
                    <!-- Ingredienti caricati dinamicamente da Firebase -->
                </div>
            </div>
        </div>
    </section>
      <!-- Il Nostro Locale Section -->
    <section id="locale" class="section" style="background-color: var(--light); display: none;">
        <div class="container">
            <h2 class="section-title"></h2>
            
            <p class="locale-intro" style="text-align: center; max-width: 800px; margin: 0 auto var(--spacing-lg);"></p>
            
            <div class="gallery-container">
                <div class="gallery-grid">
                    <!-- Galleria caricata dinamicamente da Firebase -->
                </div>
            </div>
        </div>
    </section>      <!-- Team Section -->
    <section id="team" class="section" style="display: none;">
        <div class="container">
            <h2 class="section-title" id="teamTitle"></h2>
            
            <div class="team-ampliato">
                <p id="teamIntro" style="text-align: center; max-width: 800px; margin: 0 auto var(--spacing-lg);"></p>
                
                <div class="team-container" id="teamContainer">
                    <!-- Team members will be loaded dynamically from Firebase -->
                </div>
            </div>
        </div>
    </section>
    
    <!-- CTA Section -->
    <section class="cta-section">
        <div class="container">
            <div class="cta-content">
                <h2 class="cta-title">Vieni a trovarci o ordina online!</h2>
                <p class="cta-text">Prova le nostre specialit√† nel locale o comodamente a casa tua con l'app PIZZIAMO!</p>
                <div class="cta-buttons">
                    <a href="https://maps.google.com/?q=Via+Pontegradella+289/A,+44123+Ferrara" target="_blank" class="cta-btn cta-btn-primary">
                        <i class="icon">üìç</i> Indicazioni stradali
                    </a>
                    <a href="https://wbpp.it/so/?900" class="cta-btn cta-btn-secondary">
                        <i class="icon">üõí</i> Ordina ora
                    </a>
                </div>
            </div>
        </div>
    </section>
    
    <!-- Footer -->
    <footer>
        <div class="footer-container">
            <div class="footer-column">
                <h3>Contatti</h3>
                <ul>
                    <li>Via Pontegradella 289/A, 44123 Ferrara (FE)</li>
                    <li>Tel: 000000000</li>
                    <li>Email: info@pizziamo.it</li>
                    <li>Orari: 17:00-22:00</li>
                </ul>
            </div>
            <div class="footer-column">
                <h3>Link Utili</h3>
                <ul>
                    <li><a href="#">Privacy Policy</a></li>
                </ul>
            </div>
        </div>
        <div class="copyright">
            <p>&copy; 2025 PIZZIAMO?! Tutti i diritti riservati.</p>
        </div>
    </footer>
    
    <!-- Lightbox -->
    <div class="lightbox" id="gallery-lightbox">
        <div class="lightbox-content">
            <button class="lightbox-close" id="lightbox-close">√ó</button>
            <img src="" alt="" class="lightbox-img" id="lightbox-img">
        </div>
    </div>
    
    <script type="module">
        import { db } from './js/firebase-config.js';
        import { collection, getDocs, query, orderBy, doc, getDoc } from "https://www.gstatic.com/firebasejs/9.6.10/firebase-firestore.js";

        document.addEventListener('DOMContentLoaded', async function() {            // CARICA STORIA DA FIREBASE
            async function loadStoriaFromFirebase() {
                try {
                    const storiaDocRef = doc(db, 'settings', 'storia');
                    const docSnap = await getDoc(storiaDocRef);
                    
                    if (docSnap.exists()) {
                        const storia = docSnap.data();
                        
                        // Aggiorna titolo
                        const storiaTitolo = document.querySelector('#storia .section-title');
                        if (storiaTitolo && storia.titolo) {
                            storiaTitolo.textContent = storia.titolo;
                        }
                        
                        // Aggiorna contenuto
                        const storiaContent = document.querySelector('.storia-content');
                        if (storiaContent && storia.contenuto) {
                            storiaContent.innerHTML = `
                                <h3 class="section-subtitle">${storia.sottotitolo || 'Come √® iniziato tutto'}</h3>
                                ${storia.contenuto}
                            `;
                        }
                        
                        // Aggiorna immagine
                        const storiaImage = document.querySelector('.storia-image');
                        if (storiaImage && storia.immagine) {
                            storiaImage.innerHTML = `
                                <img src="${storia.immagine}" alt="Storia PIZZIAMO">
                                <div class="storia-anno">${storia.anno || '2010'}</div>
                            `;
                        }
                        
                        // Mostra la sezione se abbiamo i dati
                        document.getElementById('storia').style.display = 'block';
                    } else {
                        console.log("Nessun dato storia trovato nel database");
                    }
                } catch (error) {
                    console.error("Errore durante il caricamento della storia:", error);
                    if (error.code === 'permission-denied') {
                        console.warn("Permessi insufficienti per la storia");
                    }
                }
            }// CARICA VALORI DA FIREBASE
            async function loadValoriFromFirebase() {
                try {
                    const valoriCollection = collection(db, 'valori');
                    const valoriQuery = query(valoriCollection, orderBy('order'));
                    const querySnapshot = await getDocs(valoriQuery);
                    
                    const valori = [];
                    querySnapshot.forEach((doc) => {
                        valori.push({
                            id: doc.id,
                            ...doc.data()
                        });
                    });

                    if (valori.length > 0) {
                        // Aggiorna il titolo se disponibile
                        const valoriTitolo = document.querySelector('#valori .section-title');
                        if (valoriTitolo) {
                            valoriTitolo.textContent = 'I Nostri Valori';
                        }
                        
                        const valoriContainer = document.querySelector('.valori-container');
                        valoriContainer.innerHTML = '';
                        
                        valori.forEach(valore => {
                            const valoreCard = document.createElement('div');
                            valoreCard.className = 'valore-card';
                            valoreCard.innerHTML = `
                                <div class="valore-icona">${valore.icon}</div>
                                <h3>${valore.title}</h3>
                                <p>${valore.description}</p>
                            `;
                            valoriContainer.appendChild(valoreCard);
                        });
                        
                        // Mostra la sezione se abbiamo i dati
                        document.getElementById('valori').style.display = 'block';
                    } else {
                        console.log("Nessun valore trovato nel database");
                    }
                } catch (error) {
                    console.error("Errore durante il caricamento dei valori:", error);
                    if (error.code === 'permission-denied') {
                        console.warn("Permessi insufficienti per i valori");
                    }
                }
            }// CARICA INGREDIENTI DA FIREBASE
            async function loadIngredientiFromFirebase() {
                try {
                    // Carica impostazioni
                    const settingsRef = doc(db, 'settings', 'ingredienti');
                    const settingsSnap = await getDoc(settingsRef);
                    
                    if (settingsSnap.exists()) {
                        const settings = settingsSnap.data();
                        
                        const ingredientiTitolo = document.querySelector('#ingredienti .section-title');
                        if (ingredientiTitolo && settings.titolo) {
                            ingredientiTitolo.textContent = settings.titolo;
                        }
                          const ingredientiIntro = document.querySelector('.ingredienti-intro');
                        if (ingredientiIntro && settings.introduzione) {
                            ingredientiIntro.innerHTML = `<p>${settings.introduzione}</p>`;
                        }
                    }
                    
                    // Carica ingredienti
                    const ingredientiCollection = collection(db, 'ingredienti');
                    const ingredientiQuery = query(ingredientiCollection, orderBy('order'));
                    const querySnapshot = await getDocs(ingredientiQuery);
                    
                    const ingredienti = [];
                    querySnapshot.forEach((doc) => {
                        ingredienti.push({
                            id: doc.id,
                            ...doc.data()
                        });
                    });                    if (ingredienti.length > 0) {
                        const ingredientiGrid = document.querySelector('.ingredienti-grid');
                        ingredientiGrid.innerHTML = '';
                        
                        ingredienti.forEach(ingrediente => {
                            const ingredienteItem = document.createElement('div');
                            ingredienteItem.className = 'ingrediente-item';
                            ingredienteItem.innerHTML = `
                                <div class="ingrediente-img">
                                    <img src="${ingrediente.immagine}" alt="${ingrediente.titolo}">
                                </div>
                                <div class="ingrediente-info">
                                    <h3>${ingrediente.titolo}</h3>
                                    <p>${ingrediente.descrizione}</p>
                                    <span class="ingrediente-badge">${ingrediente.badge}</span>
                                </div>
                            `;
                            ingredientiGrid.appendChild(ingredienteItem);
                        });
                        
                        // Mostra la sezione se abbiamo i dati
                        document.getElementById('ingredienti').style.display = 'block';
                    } else {
                        console.log("Nessun ingrediente trovato nel database");
                    }                } catch (error) {
                    console.error("Errore durante il caricamento degli ingredienti:", error);
                    if (error.code === 'permission-denied') {
                        console.warn("Permessi insufficienti per gli ingredienti");
                    }
                }
            }

            // CARICA GALLERIA DA FIREBASE
            async function loadGalleryFromFirebase() {
                try {
                    // Carica impostazioni
                    const settingsRef = doc(db, 'settings', 'locale');
                    const settingsSnap = await getDoc(settingsRef);
                    
                    if (settingsSnap.exists()) {
                        const settings = settingsSnap.data();
                        
                        const localeTitolo = document.querySelector('#locale .section-title');
                        if (localeTitolo && settings.titolo) {
                            localeTitolo.textContent = settings.titolo;
                        }
                          const localeIntro = document.querySelector('.locale-intro');
                        if (localeIntro && settings.introduzione) {
                            localeIntro.textContent = settings.introduzione;
                        }
                    }
                    
                    // Carica galleria
                    const galleryCollection = collection(db, 'gallery');
                    const galleryQuery = query(galleryCollection, orderBy('order'));
                    const querySnapshot = await getDocs(galleryQuery);
                    
                    const images = [];
                    querySnapshot.forEach((doc) => {
                        images.push({
                            id: doc.id,
                            ...doc.data()
                        });
                    });

                    if (images.length > 0) {
                        const galleryGrid = document.querySelector('.gallery-grid');
                        galleryGrid.innerHTML = '';
                        
                        images.forEach((image, index) => {
                            const galleryItem = document.createElement('div');
                            galleryItem.className = 'gallery-item';
                            galleryItem.setAttribute('data-img', image.url);
                            galleryItem.innerHTML = `
                                <img src="${image.url}" alt="${image.alt}">
                                <div class="gallery-overlay">
                                    <div class="gallery-caption">${image.caption}</div>
                                </div>
                            `;
                            galleryGrid.appendChild(galleryItem);                        });
                        
                        // Reinizializza i listener per la galleria
                        initializeGalleryListeners();
                        
                        // Mostra la sezione se abbiamo i dati
                        document.getElementById('locale').style.display = 'block';
                    } else {
                        console.log("Nessuna immagine di galleria trovata nel database");
                    }
                } catch (error) {
                    console.error("Errore durante il caricamento della galleria:", error);
                    if (error.code === 'permission-denied') {
                        console.warn("Permessi insufficienti per la galleria");
                    }
                }
            }

            // Funzione per inizializzare i listener della galleria
            function initializeGalleryListeners() {
                const galleryItems = document.querySelectorAll('.gallery-item');
                const lightbox = document.getElementById('gallery-lightbox');
                const lightboxImg = document.getElementById('lightbox-img');
                const lightboxClose = document.getElementById('lightbox-close');
                  galleryItems.forEach(item => {
                    item.addEventListener('click', function() {
                        const imgSrc = this.getAttribute('data-img');
                        const imgAlt = this.querySelector('img').getAttribute('alt');
                        
                        lightboxImg.src = imgSrc;
                        lightboxImg.alt = imgAlt;
                        
                        lightbox.classList.add('active');
                        document.body.style.overflow = 'hidden';
                    });
                });
                
                lightboxClose.addEventListener('click', function() {
                    lightbox.classList.remove('active');
                    document.body.style.overflow = '';
                });
                
                lightbox.addEventListener('click', function(e) {
                    if (e.target === lightbox) {
                        lightbox.classList.remove('active');
                        document.body.style.overflow = '';
                    }
                });
            }            // LOAD TEAM DATA FROM FIREBASE
            async function loadTeamFromFirebase() {
                try {
                    // Load team settings
                    const settingsRef = doc(db, 'settings', 'team');
                    const settingsSnap = await getDoc(settingsRef);
                    
                    if (settingsSnap.exists()) {
                        const settings = settingsSnap.data();
                        const teamTitle = document.getElementById('teamTitle');
                        if (teamTitle && settings.titolo) {
                            teamTitle.textContent = settings.titolo;
                        }
                        
                        const teamIntro = document.getElementById('teamIntro');
                        if (teamIntro && settings.introduzione) {
                            teamIntro.textContent = settings.introduzione;
                        }
                    }
                    
                    // Load team members
                    const teamRef = collection(db, 'team');
                    const q = query(teamRef, orderBy('ordine', 'asc'));
                    const querySnapshot = await getDocs(q);
                    
                    const teamContainer = document.getElementById('teamContainer');
                    if (!teamContainer) return;
                      if (querySnapshot.empty) {
                        console.log("Nessun membro del team trovato nel database");
                        return;
                    }
                    
                    // Clear and replace with Firebase data
                    teamContainer.innerHTML = '';
                    
                    querySnapshot.forEach((doc) => {
                        const member = doc.data();
                        
                        // Only show active team members
                        if (member.status !== 1) return;
                        
                        const memberElement = document.createElement('div');
                        memberElement.className = 'team-member';
                        
                        // Build social media links
                        let socialLinks = '';
                        if (member.social) {
                            if (member.social.facebook) {
                                socialLinks += `<a href="${member.social.facebook}" target="_blank">F</a>`;
                            }
                            if (member.social.instagram) {
                                socialLinks += `<a href="${member.social.instagram}" target="_blank">I</a>`;
                            }
                            if (member.social.twitter) {
                                socialLinks += `<a href="${member.social.twitter}" target="_blank">T</a>`;
                            }
                        }
                        
                        memberElement.innerHTML = `
                            <img src="${member.image || 'img/pizzaiolo1.jpg'}" alt="${member.nome}">
                            <h3>${member.nome}</h3>
                            <p>${member.ruolo}</p>
                            <p>${member.descrizione}</p>
                            ${socialLinks ? `<div class="team-social">${socialLinks}</div>` : ''}
                        `;
                        
                        teamContainer.appendChild(memberElement);
                    });
                    
                    // Mostra la sezione se abbiamo i dati
                    document.getElementById('team').style.display = 'block';
                      } catch (error) {
                    console.error('Errore durante il caricamento del team:', error);
                    if (error.code === 'permission-denied') {
                        console.warn("Permessi insufficienti per il team");
                    }
                }
            }
            
            // Initialize gallery listeners for static content
            initializeGalleryListeners();
            
            // Load all Firebase content
            loadStoriaFromFirebase();
            loadValoriFromFirebase();
            loadIngredientiFromFirebase();
            loadGalleryFromFirebase();
            loadTeamFromFirebase();
        });
    </script>
</body>
</html>